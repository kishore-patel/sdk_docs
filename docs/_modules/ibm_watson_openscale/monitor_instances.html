<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ibm_watson_openscale.monitor_instances &mdash; IBM Watson OpenScale 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/default.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            IBM Watson OpenScale
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IBM Watson OpenScale</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ibm_watson_openscale.monitor_instances</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ibm_watson_openscale.monitor_instances</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>

<span class="c1"># Copyright 2020,2021 IBM All Rights Reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="kn">import</span> <span class="nn">inspect</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">tarfile</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">BinaryIO</span>

<span class="kn">from</span> <span class="nn">ibm_cloud_sdk_core</span> <span class="kn">import</span> <span class="n">BaseService</span>

<span class="kn">from</span> <span class="nn">ibm_watson_openscale.base_classes.tables</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ibm_watson_openscale.base_classes.watson_open_scale_v2</span> <span class="kn">import</span> <span class="n">Instances</span> <span class="k">as</span> <span class="n">BaseInstances</span>
<span class="kn">from</span> <span class="nn">ibm_watson_openscale.base_classes.watson_open_scale_v2</span> <span class="kn">import</span> <span class="n">Runs</span><span class="p">,</span> <span class="n">Measurements</span><span class="p">,</span> <span class="n">Metrics</span><span class="p">,</span> <span class="n">ExplanationTasks</span><span class="p">,</span> <span class="n">DriftService</span><span class="p">,</span> <span class="n">Target</span><span class="p">,</span> <span class="n">ExplainabilityService</span><span class="p">,</span> <span class="n">JsonPatchOperation</span><span class="p">,</span> <span class="n">DataSourceStatus</span><span class="p">,</span> <span class="n">DataSource</span><span class="p">,</span> <span class="n">DataSourceConnection</span><span class="p">,</span> <span class="n">IntegratedSystemsListEnums</span><span class="p">,</span> <span class="n">DriftV2Service</span>
<span class="kn">from</span> <span class="nn">ibm_watson_openscale.base_classes.watson_open_scale_v2</span> <span class="kn">import</span> <span class="n">get_sdk_headers</span><span class="p">,</span> <span class="n">IntegratedSystems</span>
<span class="kn">from</span> <span class="nn">ibm_watson_openscale.supporting_classes.enums</span> <span class="kn">import</span> <span class="n">TargetTypes</span><span class="p">,</span> <span class="n">FairnessMetrics</span>
<span class="kn">from</span> <span class="nn">ibm_watson_openscale.mrm_monitoring</span> <span class="kn">import</span> <span class="n">MrmMonitoring</span>
<span class="kn">from</span> <span class="nn">.mrm</span> <span class="kn">import</span> <span class="n">ModelRiskManagement</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.client</span> <span class="kn">import</span> <span class="n">WatsonOpenScaleV2Adapter</span>
    <span class="kn">from</span> <span class="nn">ibm_watson_openscale.base_classes.watson_open_scale_v2</span> <span class="kn">import</span> <span class="n">DetailedResponse</span><span class="p">,</span> <span class="n">Target</span><span class="p">,</span> \
        <span class="n">MonitorInstanceParameters</span><span class="p">,</span> <span class="n">MetricThresholdOverride</span><span class="p">,</span> \
        <span class="n">MonitorInstanceSchedule</span>

<span class="n">_DEFAULT_LIST_LENGTH</span> <span class="o">=</span> <span class="mi">50</span>


<div class="viewcode-block" id="MonitorInstances"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances">[docs]</a><span class="k">class</span> <span class="nc">MonitorInstances</span><span class="p">(</span><span class="n">BaseInstances</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manages Monitor Instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ai_client</span><span class="p">:</span> <span class="s1">&#39;WatsonOpenScaleV2Adapter&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">ai_client</span><span class="p">,</span> <span class="s1">&#39;ai_client&#39;</span><span class="p">,</span> <span class="n">BaseService</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span> <span class="o">=</span> <span class="n">ai_client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runs</span> <span class="o">=</span> <span class="n">Runs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">Measurements</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">explanation</span> <span class="o">=</span> <span class="n">ExplanationTasks</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">explanation_service</span> <span class="o">=</span> <span class="n">ExplainabilityService</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift</span> <span class="o">=</span> <span class="n">DriftService</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_v2</span> <span class="o">=</span> <span class="n">DriftV2Service</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrm_monitoring</span> <span class="o">=</span> <span class="n">MrmMonitoring</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrm</span> <span class="o">=</span> <span class="n">ModelRiskManagement</span><span class="p">(</span><span class="n">ai_client</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">watson_open_scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span>

    <span class="c1">################################################</span>
    <span class="c1">#    Hidden methods from base monitor class    #</span>
    <span class="c1">################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">() instead&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.create() instead&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">update_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">() instead&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">delete_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">() instead&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">list_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">() instead&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">add_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.create() instead&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="si">}</span><span class="s2">() is not implemented, please use &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;client.monitor_definitions.</span><span class="si">{</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">() instead&quot;</span><span class="p">)</span>

    <span class="c1">#################################################</span>
    <span class="c1">#    Overridden methods for monitor instances   #</span>
    <span class="c1">#################################################</span>

<div class="viewcode-block" id="MonitorInstances.run"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">triggered_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">business_metric_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">background_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trigger monitoring run.</span>
<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param str triggered_by: (optional) An identifier representing the source</span>
<span class="sd">               that triggered the run request (optional). One of: event, scheduler, user,</span>
<span class="sd">               webhook.</span>
<span class="sd">        :param MonitorInstanceParameters parameters: (optional) Monitoring</span>
<span class="sd">               parameters consistent with the `parameters_schema` from the monitor</span>
<span class="sd">               definition.</span>
<span class="sd">        :param MonitoringRunBusinessMetricContext business_metric_context:</span>
<span class="sd">               (optional) Properties defining the business metric context in the triggered</span>
<span class="sd">               run of AI metric calculation.</span>
<span class="sd">        :param background_mode: if set to True, run will be in asynchronous mode, if set to False</span>
<span class="sd">                it will wait for result (optional)</span>
<span class="sd">        :type background_mode: bool</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitoringRun` result</span>

<span class="sd">        A way you may use me:</span>

<span class="sd">        &gt;&gt;&gt; monitor_instance_run_info = client.monitor_instances.run(</span>
<span class="sd">                background_mode=False,</span>
<span class="sd">                monitor_instance_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># runs = Runs(watson_open_scale=self._ai_client)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">triggered_by</span><span class="o">=</span><span class="n">triggered_by</span><span class="p">,</span>
                                 <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">business_metric_context</span><span class="o">=</span><span class="n">business_metric_context</span><span class="p">)</span>

        <span class="n">run_id</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>

        <span class="k">if</span> <span class="n">background_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">check_state</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_run_details</span><span class="p">(</span>
                    <span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">monitoring_run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">state</span>

            <span class="k">def</span> <span class="nf">get_result</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">]]:</span>
                <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_run_details</span><span class="p">(</span>
                    <span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">monitoring_run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">)</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">state</span>

                <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="n">StatusStateType</span><span class="o">.</span><span class="n">FINISHED</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="s2">&quot;Successfully finished run&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">details</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;Run failed with status: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> \
                           <span class="s1">&#39;Reason: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="s2">&quot;code: </span><span class="si">{}</span><span class="s2">, message: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span>
                                                <span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">failure</span><span class="o">.</span><span class="n">errors</span><span class="p">]),</span> <span class="n">details</span>

            <span class="k">return</span> <span class="n">print_synchronous_run</span><span class="p">(</span>
                <span class="s1">&#39;Waiting for end of monitoring run </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">run_id</span><span class="p">),</span>
                <span class="n">check_state</span><span class="p">,</span>
                <span class="n">get_result</span><span class="o">=</span><span class="n">get_result</span><span class="p">,</span>
                <span class="n">success_states</span><span class="o">=</span><span class="p">[</span><span class="n">StatusStateType</span><span class="o">.</span><span class="n">FINISHED</span><span class="p">]</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.list"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">data_mart_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">monitor_definition_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">target_target_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">target_target_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List monitor instances.</span>

<span class="sd">        :param str data_mart_id: (optional) comma-separeted list of IDs.</span>
<span class="sd">        :param str monitor_definition_id: (optional) comma-separeted list of IDs.</span>
<span class="sd">        :param str target_target_id: (optional) comma-separeted list of IDs.</span>
<span class="sd">        :param str target_target_type: (optional) comma-separeted list of types.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitorInstanceCollection` result</span>

<span class="sd">        A way you may use me:</span>

<span class="sd">        &gt;&gt;&gt; monitor_instances_info = client.monitor_instances.list(</span>
<span class="sd">                data_mart_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;,</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">data_mart_id</span><span class="o">=</span><span class="n">data_mart_id</span><span class="p">,</span>
                                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="n">monitor_definition_id</span><span class="p">,</span>
                                <span class="n">target_target_id</span><span class="o">=</span><span class="n">target_target_id</span><span class="p">,</span>
                                <span class="n">target_target_type</span><span class="o">=</span><span class="n">target_target_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.show"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
             <span class="n">data_mart_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">monitor_definition_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">target_target_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">target_target_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show monitor instances. By default 10 records will be shown.</span>

<span class="sd">        :param limit: Maximal number of fetched rows. By default set to 10. (optional)</span>
<span class="sd">        :type limit: int</span>
<span class="sd">        :param str data_mart_id: (optional) comma-separeted list of IDs.</span>
<span class="sd">        :param str monitor_definition_id: (optional) comma-separeted list of IDs.</span>
<span class="sd">        :param str target_target_id: (optional) comma-separeted list of IDs.</span>
<span class="sd">        :param str target_target_type: (optional) comma-separeted list of types.</span>

<span class="sd">        :return: None</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; client.monitor_instances.show()</span>
<span class="sd">        &gt;&gt;&gt; client.monitor_instances.show(limit=20)</span>
<span class="sd">        &gt;&gt;&gt; client.monitor_instances.show(20)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;limit&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">data_mart_id</span><span class="o">=</span><span class="n">data_mart_id</span><span class="p">,</span> <span class="n">monitor_definition_id</span><span class="o">=</span><span class="n">monitor_definition_id</span><span class="p">,</span>
                             <span class="n">target_target_id</span><span class="o">=</span><span class="n">target_target_id</span><span class="p">,</span> <span class="n">target_target_type</span><span class="o">=</span><span class="n">target_target_type</span><span class="p">)</span>

        <span class="n">records</span> <span class="o">=</span> <span class="p">[[</span><span class="n">instances</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">data_mart_id</span><span class="p">,</span>
                    <span class="n">instances</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
                    <span class="n">instances</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">target_id</span><span class="p">,</span>
                    <span class="n">instances</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">target_type</span><span class="p">,</span>
                    <span class="n">instances</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">monitor_definition_id</span><span class="p">,</span>
                    <span class="n">instances</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">created_at</span><span class="p">,</span>
                    <span class="n">instances</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
                   <span class="k">for</span> <span class="n">instances</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">monitor_instances</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data_mart_id&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;target_id&#39;</span><span class="p">,</span> <span class="s1">&#39;target_type&#39;</span><span class="p">,</span> <span class="s1">&#39;monitor_definition_id&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">]</span>

        <span class="n">Table</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">records</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
            <span class="n">default_limit</span><span class="o">=</span><span class="n">_DEFAULT_LIST_LENGTH</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Monitor instances&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.show_metrics"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.show_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">show_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show metrics for monitor instance.</span>

<span class="sd">        :param monitor_instance_id: ID of the monitor instance.</span>
<span class="sd">        :type monitor_instance_id: str</span>
<span class="sd">        :param limit: maximal number of fetched rows. By default set to 10. (optional)</span>
<span class="sd">        :type limit: int</span>
<span class="sd">        :return: None</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; client.monitor_instances.show_metrics(monitor_instance_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="c1"># runs = Runs(watson_open_scale=self._ai_client)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runs</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">)</span>

        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">measurements</span> <span class="o">=</span> <span class="n">Measurements</span><span class="p">(</span><span class="n">watson_open_scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">run_id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">run</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">runs</span><span class="p">]:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">measurements</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
                <span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span>
                <span class="n">start</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="n">end_time</span><span class="p">,</span>
                <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span>
            <span class="p">)</span>

            <span class="n">records</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
                             <span class="n">metric</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                             <span class="n">measurement</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                             <span class="n">metric</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                             <span class="n">metric</span><span class="o">.</span><span class="n">lower_limit</span><span class="p">,</span>
                             <span class="n">metric</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">,</span>
                             <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">tags</span><span class="p">],</span>
                             <span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">monitor_definition_id</span><span class="p">,</span>
                             <span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">monitor_instance_id</span><span class="p">,</span>
                             <span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">run_id</span><span class="p">,</span>
                             <span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">target_type</span><span class="p">,</span>
                             <span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">target_id</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">measurements</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">measurement</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span>
                            <span class="n">metric</span> <span class="ow">in</span>
                            <span class="n">value</span><span class="o">.</span><span class="n">metrics</span><span class="p">])</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ts&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;id&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;measurement_id&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;value&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;lower_limit&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;upper_limit&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tags&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;monitor_definition_id&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;monitor_instance_id&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;run_id&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;target_type&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;target_id&#39;</span><span class="p">]</span>

        <span class="n">Table</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">records</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
            <span class="n">default_limit</span><span class="o">=</span><span class="n">_DEFAULT_LIST_LENGTH</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Monitor Runs Metrics from: </span><span class="si">{}</span><span class="s2">  till: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.create"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">monitor_definition_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">target</span><span class="p">:</span> <span class="s1">&#39;Target&#39;</span><span class="p">,</span>
               <span class="n">parameters</span><span class="p">:</span> <span class="s1">&#39;MonitorInstanceParameters&#39;</span><span class="p">,</span>
               <span class="n">data_mart_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">thresholds</span><span class="p">:</span> <span class="s1">&#39;List[MetricThresholdOverride]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">schedule</span><span class="p">:</span> <span class="s1">&#39;MonitorInstanceSchedule&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">managed_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">training_data_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">background_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
               <span class="n">skip_scheduler</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;DetailedResponse&#39;</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create monitor instance.</span>

<span class="sd">        :param str data_mart_id:</span>
<span class="sd">        :param str monitor_definition_id:</span>
<span class="sd">        :param Target target:</span>
<span class="sd">        :param MonitorInstanceParameters parameters: (optional) Monitoring</span>
<span class="sd">               parameters consistent with the `parameters_schema` from the monitor</span>
<span class="sd">               definition.</span>
<span class="sd">        :param list[MetricThresholdOverride] thresholds: (optional)</span>
<span class="sd">        :param MonitorInstanceSchedule schedule: (optional) The schedule used to</span>
<span class="sd">               control how frequently the target is monitored. The maximum frequency is</span>
<span class="sd">               once every 30 minutes.</span>
<span class="sd">               Defaults to once every hour if not specified.</span>
<span class="sd">        :param str managed_by: (optional)</span>
<span class="sd">        :param training_data_stats: Training statistic json generated using training stats notebook (https://github.com/IBM-Watson/aios-data-distribution/blob/master/training_statistics_notebook.ipynb)</span>
<span class="sd">        :param background_mode: if set to True, run will be in asynchronous mode, if set to False</span>
<span class="sd">                it will wait for result (optional)</span>
<span class="sd">        :type background_mode: bool</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitorInstanceResponse` result</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; from ibm_watson_openscale import *</span>
<span class="sd">        &gt;&gt;&gt; target = Target(</span>
<span class="sd">                target_type=TargetTypes.SUBSCRIPTION,</span>
<span class="sd">                target_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;</span>
<span class="sd">             )</span>
<span class="sd">        &gt;&gt;&gt; parameters = MonitorInstanceParameters(</span>
<span class="sd">                min_feedback_data_size=50</span>
<span class="sd">             )</span>
<span class="sd">        &gt;&gt;&gt; thresholds = [</span>
<span class="sd">                MetricThresholdOverride(</span>
<span class="sd">                    metric_id=client.monitor_definitions.MONITORS.QUALITY.METRIC.ACCURACY,</span>
<span class="sd">                    type=MetricThresholdTypes.LOWER_LIMIT,</span>
<span class="sd">                    value=0.7</span>
<span class="sd">                )</span>
<span class="sd">             ]</span>
<span class="sd">        &gt;&gt;&gt; monitor_instances_info = client.monitor_instances.create(</span>
<span class="sd">                data_mart_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;,</span>
<span class="sd">                background_mode=False,</span>
<span class="sd">                monitor_definition_id=client.monitor_definitions.MONITORS.QUALITY.ID,</span>
<span class="sd">                target=target,</span>
<span class="sd">                parameters=parameters,</span>
<span class="sd">                thresholds=thresholds</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">parameters</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error : parameters cannot be None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">training_data_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># SKIP the schedule creation if monitor is Explain and subscription type is online -- https://github.ibm.com/aiopenscale/tracker/issues/25266</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span> <span class="o">==</span> <span class="n">monitor_definition_id</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__validate_fairness_params</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>

            <span class="c1"># Skip creation of schedule for online subscription</span>
            <span class="n">global_explanation</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="s2">&quot;global_explanation.enabled&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">monitor_definition_id</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_batch_subscription</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">target_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">global_explanation</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">skip_scheduler</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;Warning : Monitor is Explain, subscription type is online and global_explanation is not enabled, so skip_scheduler is re assigned as True !&quot;</span><span class="p">)</span>
                    <span class="n">skip_scheduler</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data_mart_id</span><span class="o">=</span><span class="n">data_mart_id</span><span class="p">,</span> <span class="n">monitor_definition_id</span><span class="o">=</span><span class="n">monitor_definition_id</span><span class="p">,</span>
                                   <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">,</span>
                                   <span class="n">schedule</span><span class="o">=</span><span class="n">schedule</span><span class="p">,</span> <span class="n">managed_by</span><span class="o">=</span><span class="n">managed_by</span><span class="p">,</span> <span class="n">skip_scheduler</span><span class="o">=</span><span class="n">skip_scheduler</span><span class="p">)</span>
            <span class="n">monitor_instance_id</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_for_finished_status</span><span class="p">(</span><span class="n">background_mode</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data_stats</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;training_data_stats is empty. Please re-generate and use it&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_monitor_from_training_stats</span><span class="p">(</span><span class="n">data_mart_id</span><span class="p">,</span> <span class="n">training_data_stats</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">background_mode</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.delete"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">background_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;DetailedResponse&#39;</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete monitor instance.</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param background_mode: if set to True, run will be in asynchronous mode, if set to False</span>
<span class="sd">                it will wait for result (optional)</span>
<span class="sd">        :type background_mode: bool</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; ai_client_v2.monitor_instances.delete(</span>
<span class="sd">                background_mode=False,</span>
<span class="sd">                monitor_instance_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">background_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">check_state</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">monitor_instance_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">StatusStateType</span><span class="o">.</span><span class="n">FINISHED</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">StatusStateType</span><span class="o">.</span><span class="n">ACTIVE</span>

            <span class="k">def</span> <span class="nf">get_result</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">]]:</span>
                <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">monitor_instance_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="p">):</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">StatusStateType</span><span class="o">.</span><span class="n">FINISHED</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">StatusStateType</span><span class="o">.</span><span class="n">ACTIVE</span>

                <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="n">StatusStateType</span><span class="o">.</span><span class="n">FINISHED</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="s2">&quot;Successfully finished deleting monitor instance&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">response</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># TODO: Need to show the reason.</span>
                    <span class="k">return</span> <span class="s2">&quot;Delete monitor instance failed&quot;</span><span class="p">,</span> <span class="s1">&#39;Reason: None&#39;</span><span class="p">,</span> <span class="n">response</span>

            <span class="k">return</span> <span class="n">print_synchronous_run</span><span class="p">(</span>
                <span class="s1">&#39;Waiting for end of deleting monitor instance </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">monitor_instance_id</span><span class="p">),</span>
                <span class="n">check_state</span><span class="p">,</span>
                <span class="n">get_result</span><span class="o">=</span><span class="n">get_result</span><span class="p">,</span>
                <span class="n">success_states</span><span class="o">=</span><span class="p">[</span><span class="n">StatusStateType</span><span class="o">.</span><span class="n">FINISHED</span><span class="p">]</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.get"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get monitor instance details.</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitorInstanceResponse` result</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; monitor_instance_info = client.monitor_instances.get(</span>
<span class="sd">                monitor_instance_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.update"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">patch_document</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s1">&#39;PatchDocument&#39;</span><span class="p">],</span>
               <span class="n">update_metadata_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update monitor instance.</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param List[PatchDocument] patch_document:</span>
<span class="sd">        :param bool update_metadata_only: (optional) Flag that allows to control if</span>
<span class="sd">               the underlaying actions related to the monitor reconfiguration should be</span>
<span class="sd">               triggered.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitorInstanceResponse` result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">patch_document</span><span class="o">=</span><span class="n">patch_document</span><span class="p">,</span>
                                  <span class="n">update_metadata_only</span><span class="o">=</span><span class="n">update_metadata_only</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

    <span class="k">def</span> <span class="nf">_verify_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_set_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify if particular dataset/table exists and is loaded with any data.</span>

<span class="sd">        :param data_set_id: ID of the data set to check</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">data_set_id</span><span class="p">,</span> <span class="s1">&#39;data_set_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">data_sets</span><span class="o">.</span><span class="n">get_records_count</span><span class="p">(</span><span class="n">data_set_id</span><span class="o">=</span><span class="n">data_set_id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MissingPayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> data set table is empty.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_set_id</span><span class="p">))</span>

<div class="viewcode-block" id="MonitorInstances.get_metrics_count"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_metrics_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_metrics_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
                          <span class="n">interval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the count of the metrics.</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param datetime start: Calculations **inclusive**, internally floored to</span>
<span class="sd">               achieve full interval. If interval is vulnerable to time zone, the</span>
<span class="sd">               calculated value depends on a backend db engine: PostgreSQL respects time</span>
<span class="sd">               zone and DB2 use UTC time. Calculated value is returned in response.</span>
<span class="sd">        :param datetime end: Calculations **exclusive**, internally ceiled to</span>
<span class="sd">               achieve full interval. If interval is vulnerable to time zone, the</span>
<span class="sd">               calculated value depends on a backend db engine: PostgreSQL respects time</span>
<span class="sd">               zone and DB2 use UTC time. Calculated value is returned in response.</span>
<span class="sd">        :param str agg: Comma delimited function list constructed from metric name</span>
<span class="sd">               and function, e.g. `agg=metric_name:count,:last` that defines aggregations.</span>
<span class="sd">        :param str interval: (optional) Time unit in which metrics are grouped and</span>
<span class="sd">               aggregated, interval by interval.</span>
<span class="sd">        :param str filter: (optional) Filter expression can consist of any metric</span>
<span class="sd">               tag or a common column of string type followed by filter name and</span>
<span class="sd">               optionally a value, all delimited by colon. Supported filters are: `in`,</span>
<span class="sd">               `eq`, `null` and `exists`. Sample filters are:</span>
<span class="sd">               `filter=region:in:[us,pl],segment:eq:sales` or</span>
<span class="sd">               `filter=region:null,segment:exists`.</span>
<span class="sd">        :param str group: (optional) Comma delimited list constructed from metric</span>
<span class="sd">               tags, e.g. `group=region,segment` to group metrics before aggregations.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `DataMartGetMonitorInstanceMetrics` result</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; metrics_count = client.monitor_instances.get_metrics_count(</span>
<span class="sd">                monitor_instance_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;,</span>
<span class="sd">                start=start_time,</span>
<span class="sd">                end=end_time,</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">Metrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
                                <span class="n">agg</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.get_metrics"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">get_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
                    <span class="n">agg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all the generated metrics between start and end date for specific monitor instance id</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param datetime start: Calculations **inclusive**, internally floored to</span>
<span class="sd">               achieve full interval. If interval is vulnerable to time zone, the</span>
<span class="sd">               calculated value depends on a backend db engine: PostgreSQL respects time</span>
<span class="sd">               zone and DB2 use UTC time. Calculated value is returned in response.</span>
<span class="sd">        :param datetime end: Calculations **exclusive**, internally ceiled to</span>
<span class="sd">               achieve full interval. If interval is vulnerable to time zone, the</span>
<span class="sd">               calculated value depends on a backend db engine: PostgreSQL respects time</span>
<span class="sd">               zone and DB2 use UTC time. Calculated value is returned in response.</span>
<span class="sd">        :param str agg: Comma delimited function list constructed from metric name</span>
<span class="sd">               and function, e.g. `agg=metric_name:count,:last` that defines aggregations.</span>
<span class="sd">        :param str interval: (optional) Time unit in which metrics are grouped and</span>
<span class="sd">               aggregated, interval by interval.</span>
<span class="sd">        :param str filter: (optional) Filter expression can consist of any metric</span>
<span class="sd">               tag or a common column of string type followed by filter name and</span>
<span class="sd">               optionally a value, all delimited by colon. Supported filters are: `in`,</span>
<span class="sd">               `eq`, `null` and `exists`. Sample filters are:</span>
<span class="sd">               `filter=region:in:[us,pl],segment:eq:sales` or</span>
<span class="sd">               `filter=region:null,segment:exists`.</span>
<span class="sd">        :param str group: (optional) Comma delimited list constructed from metric</span>
<span class="sd">               tags, e.g. `group=region,segment` to group metrics before aggregations.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `DataMartGetMonitorInstanceMetrics` result</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; metrics_count = client.monitor_instances.get_metrics_count(</span>
<span class="sd">                monitor_instance_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;,</span>
<span class="sd">                start=start_time,</span>
<span class="sd">                end=end_time,</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">Metrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
                                <span class="n">agg</span><span class="o">=</span><span class="n">agg</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.upload_drift_model"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.upload_drift_model">[docs]</a>    <span class="k">def</span> <span class="nf">upload_drift_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_mart_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                           <span class="n">archive_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;user_drift.tar.gz&quot;</span><span class="p">,</span> <span class="n">enable_data_drift</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="n">enable_model_drift</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload a Drift model to be able to compute Drift monitor.</span>

<span class="sd">        :param str model_path: (required) path to the drift model</span>
<span class="sd">        :param str data_mart_id: (required) data_mart ID</span>
<span class="sd">        :param str subscription_id: (required) subscription ID</span>
<span class="sd">        :param str archive_name: (optional) Archive name to use while storing tarball in datamart</span>
<span class="sd">        :param str enable_data_drift: (optional) If data drift is expected to be enabled for this subscription.</span>
<span class="sd">            If set to True, archive is verified to contain a valid data constraints json file.</span>
<span class="sd">        :param str enable_model_drift: (optional) If model drift is expected to be enabled for this subscription.</span>
<span class="sd">            If set to True, archive is verified to contain a valid drift model pickle file.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; client.monitor_instances.upload_drift_model(</span>
<span class="sd">                model_path=&#39;drift_models/drift_detection_model.tar.gz&#39;,</span>
<span class="sd">                data_mart_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;,</span>
<span class="sd">                subscription_id=&#39;997b1474-00d2-4g05-ac02-287ebfc603b5&#39;,</span>
<span class="sd">             )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">drift_model</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift</span><span class="o">.</span><span class="n">drift_archive_post</span><span class="p">(</span><span class="n">data_mart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">drift_model</span><span class="p">,</span> <span class="n">archive_name</span><span class="o">=</span><span class="n">archive_name</span><span class="p">,</span>
                                                 <span class="n">enable_data_drift</span><span class="o">=</span><span class="n">enable_data_drift</span><span class="p">,</span> <span class="n">enable_model_drift</span><span class="o">=</span><span class="n">enable_model_drift</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.download_drift_model"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.download_drift_model">[docs]</a>    <span class="k">def</span> <span class="nf">download_drift_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DetailedResponse&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads the model.</span>

<span class="sd">        :param str monitor_instance_id: (required) The Drift monitor instance ID.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; client.monitor_instances.download_drift_model(</span>
<span class="sd">            monitor_instance_id=&quot;0a9a4b85-f2bb-46de-850b-f033d7d37d9a&quot;</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift</span><span class="o">.</span><span class="n">drift_archive_get</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.download_drift_model_metadata"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.download_drift_model_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">download_drift_model_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DetailedResponse&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads the model metadata.</span>

<span class="sd">        :param str monitor_instance_id: (required) The Drift monitor instance ID.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>

<span class="sd">        A way you might use me is:</span>

<span class="sd">        &gt;&gt;&gt; client.monitor_instances.download_drift_model_metadata(</span>
<span class="sd">            monitor_instance_id=&quot;0a9a4b85-f2bb-46de-850b-f033d7d37d9a&quot;</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift</span><span class="o">.</span><span class="n">drift_archive_head</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="MonitorInstances.list_runs"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.list_runs">[docs]</a>    <span class="k">def</span> <span class="nf">list_runs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List monitoring runs.</span>

<span class="sd">        List monitoring runs.</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param str start: (optional) The page token indicating where to start</span>
<span class="sd">               paging from.</span>
<span class="sd">        :param int limit: (optional) The limit of the number of items to return,</span>
<span class="sd">               for example limit=50. If not specified a default of 100 will be  used.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitoringRunCollection` result</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># runs = Runs(watson_open_scale=self._ai_client)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runs</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.get_run_details"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_run_details">[docs]</a>    <span class="k">def</span> <span class="nf">get_run_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">monitoring_run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get monitoring run details.</span>
<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param str monitoring_run_id: Unique monitoring run ID.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitoringRun` result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># runs = Runs(watson_open_scale=self._ai_client)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">monitoring_run_id</span><span class="o">=</span><span class="n">monitoring_run_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.explanation_tasks"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.explanation_tasks">[docs]</a>    <span class="k">def</span> <span class="nf">explanation_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scoring_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">input_rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">explanation_types</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">subscription_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute explanations.</span>

<span class="sd">        Submit tasks for computing explanation of predictions.</span>

<span class="sd">        :param List[str] scoring_ids: IDs of the scoring transaction.</span>
<span class="sd">        :param List[dict] input_rows: (optional) List of scoring transactions.</span>
<span class="sd">        :param List[str] explanation_types: (optional) Types of explanations to</span>
<span class="sd">               generate.</span>
<span class="sd">        :param str subscription_id: (optional) Unique subscription ID.               </span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `PostExplanationTaskResponse` result</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">explanation</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">scoring_ids</span><span class="o">=</span><span class="n">scoring_ids</span><span class="p">,</span> <span class="n">input_rows</span><span class="o">=</span><span class="n">input_rows</span><span class="p">,</span> <span class="n">explanation_types</span><span class="o">=</span><span class="n">explanation_types</span><span class="p">,</span> <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.get_explanation_tasks"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_explanation_tasks">[docs]</a>    <span class="k">def</span> <span class="nf">get_explanation_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">explanation_task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscription_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get explanation.</span>

<span class="sd">        Get explanation for the given explanation task id.</span>

<span class="sd">        :param str explanation_task_id: ID of the explanation task.</span>
<span class="sd">        :param str subscription_id: Unique subscription ID.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `GetExplanationTaskResponse` result</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">explanation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">explanation_task_id</span><span class="o">=</span><span class="n">explanation_task_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.get_all_explaination_tasks"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_all_explaination_tasks">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_explaination_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subscription_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scoring_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all explanations.</span>

<span class="sd">        List of all the computed explanations.</span>

<span class="sd">        :param str subscription_id: Unique subscription ID.</span>
<span class="sd">        :param int offset: (optional) offset of the explanations to return.</span>
<span class="sd">        :param int limit: (optional) Maximum number of explanations to return.</span>
<span class="sd">        :param str scoring_id: (optional) ID of the scoring transaction.</span>
<span class="sd">        :param str status: (optional) Status of the explanation task.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `GetExplanationTasksResponse` result</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">explanation</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">scoring_id</span><span class="o">=</span><span class="n">scoring_id</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.get_measurement_details"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_measurement_details">[docs]</a>    <span class="k">def</span> <span class="nf">get_measurement_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">measurement_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get Measurement details.</span>
<span class="sd">        Get Measurement info for the given measurement and monitor  instance id.</span>
<span class="sd">        :param str monitor_instance_id: ID of the monitor instance.</span>
<span class="sd">        :param str measurement_id: ID of the measurement.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse with `MonitorMeasurementResponse` result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">measurement_id</span><span class="o">=</span><span class="n">measurement_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># private method to check for finished state</span>
    <span class="k">def</span> <span class="nf">__check_for_finished_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">background_mode</span><span class="p">,</span> <span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">background_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">check_state</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">state</span>

            <span class="k">def</span> <span class="nf">get_result</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">]]:</span>
                <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">)</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">state</span>

                <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="n">StatusStateType</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="s2">&quot;Monitor instance successfully created&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">details</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;Monitor instance creation failed with status: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> \
                           <span class="s1">&#39;Reason: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="s2">&quot;code: </span><span class="si">{}</span><span class="s2">, message: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span>
                                                <span class="n">details</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">failure</span><span class="o">.</span><span class="n">errors</span><span class="p">]),</span> <span class="n">details</span>

            <span class="k">return</span> <span class="n">print_synchronous_run</span><span class="p">(</span>
                <span class="s1">&#39;Waiting for end of monitor instance creation </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">monitor_instance_id</span><span class="p">),</span>
                <span class="n">check_state</span><span class="p">,</span>
                <span class="n">get_result</span><span class="o">=</span><span class="n">get_result</span><span class="p">,</span>
                <span class="n">success_states</span><span class="o">=</span><span class="p">[</span><span class="n">StatusStateType</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="c1"># private method to create monitors from training stats</span>
    <span class="k">def</span> <span class="nf">__create_monitor_from_training_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_mart_id</span><span class="p">,</span> <span class="n">training_stats_info</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">background_mode</span><span class="p">):</span>
        <span class="n">subscription_id</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subscription_id&quot;</span><span class="p">)</span>

        <span class="n">validate_type</span><span class="p">(</span><span class="n">data_mart_id</span><span class="p">,</span> <span class="s1">&#39;data_mart_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="s1">&#39;subscription_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">responses</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s1">&#39;fairness_configuration&#39;</span> <span class="ow">in</span> <span class="n">training_stats_info</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span>
                <span class="n">target_type</span><span class="o">=</span><span class="n">TargetTypes</span><span class="o">.</span><span class="n">SUBSCRIPTION</span><span class="p">,</span>
                <span class="n">target_id</span><span class="o">=</span><span class="n">subscription_id</span>
            <span class="p">)</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">training_stats_info</span><span class="p">[</span><span class="s2">&quot;fairness_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__validate_fairness_params</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;model_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">training_stats_info</span><span class="p">[</span><span class="s1">&#39;common_configuration&#39;</span><span class="p">][</span><span class="s1">&#39;problem_type&#39;</span><span class="p">]</span>
            <span class="n">thresholds</span> <span class="o">=</span> <span class="n">training_stats_info</span><span class="p">[</span><span class="s2">&quot;fairness_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;thresholds&quot;</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating fairness monitor&quot;</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="n">data_mart_id</span><span class="o">=</span><span class="n">data_mart_id</span><span class="p">,</span>
                <span class="n">background_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span>

            <span class="n">mon_resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_for_finished_status</span><span class="p">(</span>
                <span class="n">background_mode</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
            <span class="n">responses</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">mon_resp</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;explainability_configuration&#39;</span> <span class="ow">in</span> <span class="n">training_stats_info</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span>
                <span class="n">target_type</span><span class="o">=</span><span class="n">TargetTypes</span><span class="o">.</span><span class="n">SUBSCRIPTION</span><span class="p">,</span>
                <span class="n">target_id</span><span class="o">=</span><span class="n">subscription_id</span>
            <span class="p">)</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;training_statistics&quot;</span><span class="p">:</span> <span class="n">training_stats_info</span><span class="p">[</span><span class="s2">&quot;explainability_configuration&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating Explain monitor&quot;</span><span class="p">)</span>

            <span class="c1"># SKIP the schedule creation for Explain monitor -- https://github.ibm.com/aiopenscale/tracker/issues/25266</span>
            <span class="n">skip_scheduler</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Don&#39;t skip if it is a batch subscription or if global explanation is enabled</span>
            <span class="n">global_explanation</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
                <span class="n">training_stats_info</span><span class="p">,</span> <span class="s2">&quot;explainability_configuration.parameters.global_explanation.enabled&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_batch_subscription</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span> <span class="ow">or</span> <span class="n">global_explanation</span><span class="p">:</span>
                <span class="n">skip_scheduler</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="n">data_mart_id</span><span class="o">=</span><span class="n">data_mart_id</span><span class="p">,</span>
                <span class="n">background_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                <span class="n">skip_scheduler</span><span class="o">=</span><span class="n">skip_scheduler</span>
            <span class="p">)</span>

            <span class="n">mon_resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_for_finished_status</span><span class="p">(</span>
                <span class="n">background_mode</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
            <span class="n">responses</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">mon_resp</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">responses</span>

<div class="viewcode-block" id="MonitorInstances.add_measurements"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.add_measurements">[docs]</a>    <span class="k">def</span> <span class="nf">add_measurements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">monitor_instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">monitor_measurement_request</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s1">&#39;MonitorMeasurementRequest&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Publish measurement data to OpenScale.</span>

<span class="sd">        Publish measurement data to OpenScale for a specific monitor instance.</span>

<span class="sd">        :param str monitor_instance_id: Unique monitor instance ID.</span>
<span class="sd">        :param List[MonitorMeasurementRequest] monitor_measurement_request:</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">monitor_instance_id</span><span class="o">=</span><span class="n">monitor_instance_id</span><span class="p">,</span> <span class="n">monitor_measurement_request</span><span class="o">=</span><span class="n">monitor_measurement_request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.upload_explainability_archive"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.upload_explainability_archive">[docs]</a>    <span class="k">def</span> <span class="nf">upload_explainability_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">archive</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload explainability archives.</span>

<span class="sd">        API to upload explainability archives such as the Perturbations scoring response</span>
<span class="sd">        archive. The api can also be used to update the archive.</span>

<span class="sd">        :param str subscription_id: Unique subscription ID.</span>
<span class="sd">        :param BinaryIO archive: explanation Archive</span>
<span class="sd">        :rtype: DetailedResponse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">explanation_service</span><span class="o">.</span><span class="n">explainability_archive_post</span><span class="p">(</span><span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">archive</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MonitorInstances.get_explainability_archive"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_explainability_archive">[docs]</a>    <span class="k">def</span> <span class="nf">get_explainability_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the Explainability archives.</span>

<span class="sd">        API to retrieve the Explainability archives.</span>

<span class="sd">        :param str subscription_id: Unique subscription ID.</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">explanation_service</span><span class="o">.</span><span class="n">explainability_archive_get</span><span class="p">(</span><span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__is_batch_subscription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">ai_client</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">deployment</span><span class="o">.</span><span class="n">deployment_type</span> <span class="o">==</span> <span class="s1">&#39;batch&#39;</span>

<div class="viewcode-block" id="MonitorInstances.enable_monitor_using_training_data"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.enable_monitor_using_training_data">[docs]</a>    <span class="k">def</span> <span class="nf">enable_monitor_using_training_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">monitors_config</span><span class="p">,</span> <span class="n">drifted_transaction_table</span><span class="o">=</span><span class="p">{},</span> <span class="n">explain_queue_table</span><span class="o">=</span><span class="p">{},</span> <span class="n">explain_results_table</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Enable configured monitors and learn stats online</span>

<span class="sd">            :param str datamart_id: Datamart id in which we want to to create this subscription.</span>
<span class="sd">            :param str subscription_id: subscription id</span>
<span class="sd">            :param dict monitors_config: configuration params for monitors</span>
<span class="sd">                Format for the monitors_config is as follows</span>
<span class="sd">                monitors_config = {</span>
<span class="sd">                    &quot;fairness_configuration&quot;: {</span>
<span class="sd">                        &quot;enabled&quot;: True,</span>
<span class="sd">                        &quot;parameters&quot;: {</span>
<span class="sd">                        },</span>
<span class="sd">                        &quot;thresholds&quot;: [</span>
<span class="sd">                        ]</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;quality_configuration&quot;: {</span>
<span class="sd">                            &quot;enabled&quot;: True,</span>
<span class="sd">                            &quot;parameters&quot; : {</span>
<span class="sd">                            },</span>
<span class="sd">                            &quot;thresholds&quot; : []</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;explainability_configuration&quot;:{</span>
<span class="sd">                            &quot;enabled&quot;: True,</span>
<span class="sd">                            &quot;parameters&quot; : {</span>
<span class="sd">                                &quot;enable_online_learning&quot;: True</span>
<span class="sd">                            }</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;drift_configuration&quot;: {</span>
<span class="sd">                            &quot;enabled&quot;: True,</span>
<span class="sd">                            &quot;parameters&quot; : {</span>
<span class="sd">                            &quot;train_drift_model&quot;: True</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                }</span>
<span class="sd">            :param dict drifted_transaction_table: Dictionary containing drifted transaction table connection information. Required if drift is to be configured</span>
<span class="sd">                Format for the drifted transaction table is as follows</span>
<span class="sd">                drifted_transaction_table = {</span>
<span class="sd">                    &quot;data&quot;: {</span>
<span class="sd">                        &quot;auto_create&quot;: False,</span>
<span class="sd">                        &quot;database&quot;: &quot;SAMPLE&quot;,</span>
<span class="sd">                        &quot;schema&quot;: &quot;KP&quot;,</span>
<span class="sd">                        &quot;table&quot;: &quot;DRIFTED_TRANSACTION_TABLE&quot;</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;parameters&quot;:{</span>
<span class="sd">                        &quot;partition_column&quot;: &quot;WOS_PARTITION_COLUMN&quot;,</span>
<span class="sd">                        &quot;num_partitions&quot;: 12</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            :param dict explain_queue_table: Dictionary containing explanation queue table connection information. Required if explanation is to be configured.</span>
<span class="sd">                Format for the explain_queue_table is same as drifted transaction table</span>
<span class="sd">            :param dict explain_results_table: Dictionary containing explanation results table connection information. Required if explanation is to be configured.</span>
<span class="sd">                Format for the explain_results_table is same as drifted transaction table</span>
<span class="sd">            :return: list containing monitor instance ids</span>
<span class="sd">            :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">validate_type</span><span class="p">(</span><span class="n">datamart_id</span><span class="p">,</span> <span class="s1">&#39;data_mart_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="s1">&#39;subscription_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Verify subscription is in “active” state</span>
        <span class="n">subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">subscription_id</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">get</span><span class="p">(</span><span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.status.state&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;active&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Subscription is not in active state. Make sure subscription was created successfully&quot;</span><span class="p">)</span>

        <span class="c1"># Verify subscription is batch</span>
        <span class="k">if</span> <span class="n">get</span><span class="p">(</span><span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.analytics_engine.type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;spark&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Enabling monitors with training data is only available for batch subscription.&quot;</span><span class="p">)</span>

        <span class="c1"># Load monitors_config</span>
        <span class="n">monitor_instance_ids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">enable_fairness</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;fairness_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span>
        <span class="n">enable_quality</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;quality_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span>
        <span class="n">enable_explainability</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;explainability_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span>
        <span class="n">enable_drift</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;drift_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span>

        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_target_obj</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
        <span class="n">data_sources</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.data_sources&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="n">enable_explainability</span> <span class="ow">or</span> <span class="n">enable_drift</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sources</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;Data sources not found for creating explain tables&quot;</span><span class="p">)</span>
        <span class="n">db_integrated_system_id</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
            <span class="n">data_sources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;connection.integrated_system_id&quot;</span><span class="p">)</span>
        <span class="n">source_type</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">data_sources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;connection.type&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">enable_explainability</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling Explainability....&quot;</span><span class="p">)</span>

            <span class="n">scoring_endpoint</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
                <span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.deployment.scoring_endpoint&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">get</span><span class="p">(</span><span class="n">scoring_endpoint</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;Missing Scoring url : Scoring url is mandatory for the subscription to enable explainability&quot;</span><span class="p">)</span>

            <span class="c1"># Patch Data Sources</span>
            <span class="n">explain_queue_data_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_data_source</span><span class="p">(</span>
                <span class="n">explain_queue_table</span><span class="p">,</span> <span class="n">db_integrated_system_id</span><span class="p">,</span> <span class="s2">&quot;explain_queue&quot;</span><span class="p">,</span> <span class="n">source_type</span><span class="p">)</span>
            <span class="n">explain_result_data_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_data_source</span><span class="p">(</span>
                <span class="n">explain_results_table</span><span class="p">,</span> <span class="n">db_integrated_system_id</span><span class="p">,</span> <span class="s2">&quot;explain_result&quot;</span><span class="p">,</span> <span class="n">source_type</span><span class="p">)</span>
            <span class="n">data_source_patch_document</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">JsonPatchOperation</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">OperationTypes</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data_sources/-&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">explain_queue_data_source</span><span class="p">),</span>
                <span class="n">JsonPatchOperation</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">OperationTypes</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data_sources/-&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">explain_result_data_source</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">patch_document</span><span class="o">=</span><span class="n">data_source_patch_document</span><span class="p">)</span>
            <span class="c1"># Enable Explainability</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;explainability_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span>
            <span class="n">monitor_instance_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
            <span class="n">explain_mon_id</span> <span class="o">=</span> <span class="n">monitor_instance_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">explain_mon_id</span>

        <span class="k">if</span> <span class="n">enable_fairness</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling fairness....&quot;</span><span class="p">)</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;fairness_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span>
            <span class="n">thresholds</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;fairness_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;thresholds&quot;</span><span class="p">]</span>
            <span class="n">monitor_instance_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
            <span class="n">fairness_id</span> <span class="o">=</span> <span class="n">monitor_instance_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">fairness_id</span>

        <span class="k">if</span> <span class="n">enable_quality</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling Quality....&quot;</span><span class="p">)</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;quality_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span>
            <span class="n">thresholds</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;quality_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;thresholds&quot;</span><span class="p">]</span>
            <span class="n">monitor_instance_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">QUALITY</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
            <span class="n">quality_id</span> <span class="o">=</span> <span class="n">monitor_instance_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">QUALITY</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">quality_id</span>

        <span class="k">if</span> <span class="n">enable_drift</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling Drift....&quot;</span><span class="p">)</span>
            <span class="c1"># Patch Data Sources</span>
            <span class="n">drift_data_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_data_source</span><span class="p">(</span>
                <span class="n">drifted_transaction_table</span><span class="p">,</span> <span class="n">db_integrated_system_id</span><span class="p">,</span> <span class="s2">&quot;drift&quot;</span><span class="p">,</span> <span class="n">source_type</span><span class="p">)</span>
            <span class="n">data_source_patch_document</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">JsonPatchOperation</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">OperationTypes</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data_sources/-&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">drift_data_source</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">patch_document</span><span class="o">=</span><span class="n">data_source_patch_document</span><span class="p">)</span>
            <span class="c1"># Enable Drift</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">monitors_config</span><span class="p">[</span><span class="s2">&quot;drift_configuration&quot;</span><span class="p">][</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span>
            <span class="n">drift_monitor_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
                <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">DRIFT</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span>
            <span class="p">)</span><span class="o">.</span><span class="n">result</span>
            <span class="n">drift_mon_id</span> <span class="o">=</span> <span class="n">drift_monitor_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">DRIFT</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">drift_mon_id</span>

        <span class="k">return</span> <span class="n">monitor_instance_ids</span></div>

<div class="viewcode-block" id="MonitorInstances.enable_monitors"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.enable_monitors">[docs]</a>    <span class="k">def</span> <span class="nf">enable_monitors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datamart_id</span><span class="p">,</span> <span class="n">service_provider_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">,</span> <span class="n">drifted_transaction_table</span><span class="o">=</span><span class="p">{},</span> <span class="n">explain_queue_table</span><span class="o">=</span><span class="p">{},</span> <span class="n">explain_results_table</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Enable configured monitors using configuration archive file</span>

<span class="sd">            :param str datamart_id: Datamart id in which we want to to create this subscription.</span>
<span class="sd">            :param str service_provider_id: Service Provider id.            </span>
<span class="sd">            :param str configuration_archive: Path to the configuration archive.</span>
<span class="sd">            :param dict drifted_transaction_table: Dictionary containing drifted transaction table connection information. Required if drift is to be configured    </span>
<span class="sd">                Format for the drifted transaction table is as follows</span>
<span class="sd">                    drifted_transaction_table = {</span>
<span class="sd">                        &quot;data&quot;: {</span>
<span class="sd">                            &quot;auto_create&quot;: True,</span>
<span class="sd">                            &quot;database&quot;: &quot;SAMPLE&quot;,</span>
<span class="sd">                            &quot;schema&quot;: &quot;KP&quot;,</span>
<span class="sd">                            &quot;table&quot;: &quot;drifted_transactions_table_new&quot;</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">            :param dict explain_queue_table: Dictionary containing explanation queue table connection information. Required if explanation is to be configured.</span>
<span class="sd">                Format for the explain_queue_table is same as drifted transaction table</span>
<span class="sd">            :param dict explain_results_table: Dictionary containing explanation results table connection information. Required if explanation is to be configured.</span>
<span class="sd">                Format for the explain_results_table is same as drifted transaction table</span>

<span class="sd">            :return: list containing monitor instance ids</span>
<span class="sd">            :rtype: list</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">validate_type</span><span class="p">(</span><span class="n">datamart_id</span><span class="p">,</span> <span class="s1">&#39;data_mart_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">service_provider_id</span><span class="p">,</span> <span class="s1">&#39;service_provider_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="s1">&#39;subscription_id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># validate_type(configuration_archive, &#39;configuration_archive&#39;, str, True)</span>

        <span class="n">common_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_common_configuration</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">)</span>
        <span class="n">common_configuration</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">common_config</span><span class="p">,</span> <span class="s1">&#39;common_configuration&#39;</span><span class="p">)</span>

        <span class="n">enable_fairness</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">common_configuration</span><span class="p">,</span> <span class="s2">&quot;enable_fairness&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">enable_explainability</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
            <span class="n">common_configuration</span><span class="p">,</span> <span class="s2">&quot;enable_explainability&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">enable_quality</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">common_configuration</span><span class="p">,</span> <span class="s2">&quot;enable_quality&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">enable_drift</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">common_configuration</span><span class="p">,</span> <span class="s2">&quot;enable_drift&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">monitor_instance_ids</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">subscription_id</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">get</span><span class="p">(</span><span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.status.state&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;active&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Subscription is not in active state. Make sure subscription was created successfully&quot;</span><span class="p">)</span>

        <span class="n">subscription_name</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.asset.name&quot;</span><span class="p">)</span>
        <span class="n">data_sources</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">subscription</span><span class="p">,</span> <span class="s2">&quot;entity.data_sources&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="c1"># Validate individual monitor required information</span>
        <span class="n">fairness_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">enable_fairness</span><span class="p">:</span>
            <span class="n">fairness_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_fairness_configuration</span><span class="p">(</span>
                <span class="n">configuration_archive</span><span class="p">)</span>

        <span class="n">explain_statistics</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">enable_explainability</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__validate_table_info</span><span class="p">(</span><span class="n">explain_results_table</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__validate_table_info</span><span class="p">(</span><span class="n">explain_queue_table</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sources</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;Data sources not found for creating explain tables&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;explainability.tar.gz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s2">&quot;explainability_statistics.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;explainability_perturbations.tar.gz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                            <span class="s2">&quot;explainability.tar.gz file is missing in archive file&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;explainability_statistics.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                                <span class="s2">&quot;explainability_statistics.json file is missing in archive file&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">explain_statistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_explainability_statistics</span><span class="p">(</span>
                                <span class="n">configuration_archive</span><span class="p">)</span>

                        <span class="k">if</span> <span class="s2">&quot;explainability_perturbations.tar.gz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                                <span class="s2">&quot;explainability_perturbations.tar.gz file is missing in archive file&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">enable_drift</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__validate_table_info</span><span class="p">(</span><span class="n">drifted_transaction_table</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_sources</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;Data sources not found for creating drift tables&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;drift_archive.tar.gz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s2">&quot;drift_archive.tar.gz file is missing in archive file&quot;</span><span class="p">)</span>

                <span class="n">tar_file</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s2">&quot;drift_archive.tar.gz&quot;</span><span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;drift.tar.gz&quot;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tar_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

                <span class="c1"># Upload drift monitor</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_instances</span><span class="o">.</span><span class="n">upload_drift_model</span><span class="p">(</span>
                    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;drift.tar.gz&quot;</span><span class="p">,</span>
                    <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
                    <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span>
                <span class="p">)</span><span class="o">.</span><span class="n">result</span>

        <span class="k">if</span> <span class="n">enable_fairness</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling fairness....&quot;</span><span class="p">)</span>
            <span class="n">fairness_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_fairness_monitor</span><span class="p">(</span>
                <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">fairness_config</span><span class="p">)</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">fairness_id</span>

        <span class="k">if</span> <span class="n">enable_quality</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling Quality....&quot;</span><span class="p">)</span>
            <span class="n">quality_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_quality_monitor</span><span class="p">(</span>
                <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">)</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">QUALITY</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">quality_id</span>

        <span class="k">if</span> <span class="n">enable_drift</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling Drift....&quot;</span><span class="p">)</span>
            <span class="n">drift_mon_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_drift_monitor</span><span class="p">(</span>
                <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">,</span> <span class="n">common_configuration</span><span class="p">,</span> <span class="n">drifted_transaction_table</span><span class="p">,</span> <span class="n">data_sources</span><span class="p">)</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">DRIFT</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">drift_mon_id</span>

        <span class="k">if</span> <span class="n">enable_explainability</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enabling Explainability....&quot;</span><span class="p">)</span>

            <span class="n">explain_mon_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_explain_monitor</span><span class="p">(</span>
                <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">explain_statistics</span><span class="p">,</span> <span class="n">explain_queue_table</span><span class="p">,</span> <span class="n">explain_results_table</span><span class="p">,</span> <span class="n">data_sources</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">)</span>
            <span class="n">monitor_instance_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">explain_mon_id</span>

        <span class="k">return</span> <span class="n">monitor_instance_ids</span></div>
    
<div class="viewcode-block" id="MonitorInstances.get_drift_v2_archive_metadata"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.get_drift_v2_archive_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_drift_v2_archive_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">archive_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get drift archive metadata for a given subscription.</span>

<span class="sd">        :param str subscription_id: The id of the subscription.</span>
<span class="sd">        :param str archive_id: (optional) The id of the archive for which the metadata needs to be downloaded. </span>
<span class="sd">           It will download the metadata for the latest baseline archive by default..</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_v2</span><span class="o">.</span><span class="n">download_drift_v2_archive_metadata</span><span class="p">(</span><span class="n">subscription_id</span> <span class="o">=</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">archive_id</span> <span class="o">=</span> <span class="n">archive_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MonitorInstances.upload_drift_v2_archive"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.upload_drift_v2_archive">[docs]</a>    <span class="k">def</span> <span class="nf">upload_drift_v2_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">archive_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">archive_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload drift_v2 archive for a given subscription.</span>

<span class="sd">        This API is used to upload the drift_v2 archive necessary to configure the Drift</span>
<span class="sd">        v2 monitor.</span>

<span class="sd">        :param str subscription_id: The id of the subscription.</span>
<span class="sd">        :param archive_path: The path of the archive being uploaded </span>
<span class="sd">        :param str archive_name: (optional) The name of the archive being uploaded.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">archive_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;archive_path must be provided&#39;</span><span class="p">)</span>
        
        <span class="n">body</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
         
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_v2</span><span class="o">.</span><span class="n">upload_drift_v2_archive</span><span class="p">(</span><span class="n">subscription_id</span> <span class="o">=</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">,</span> <span class="n">archive_name</span> <span class="o">=</span> <span class="n">archive_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span></div>
    
<div class="viewcode-block" id="MonitorInstances.download_drift_v2_archive"><a class="viewcode-back" href="../../index.html#ibm_watson_openscale.monitor_instances.MonitorInstances.download_drift_v2_archive">[docs]</a>    <span class="k">def</span> <span class="nf">download_drift_v2_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">archive_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DetailedResponse&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get drift v2 archive for a given subscription.</span>

<span class="sd">        This API is used to download the drift_v2 Archives.</span>

<span class="sd">        :param str subscription_id: The id of the subscription.</span>
<span class="sd">        :param str archive_id: (optional) The id of the archive to be downloaded.</span>
<span class="sd">               It will download the latest baseline archive by default.</span>
<span class="sd">        :param dict headers: A `dict` containing the request headers</span>
<span class="sd">        :return: A `DetailedResponse` containing the result, headers and HTTP status code.</span>
<span class="sd">        :rtype: DetailedResponse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_v2</span><span class="o">.</span><span class="n">download_drift_v2_archive</span><span class="p">(</span><span class="n">subscription_id</span> <span class="o">=</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">archive_id</span> <span class="o">=</span> <span class="n">archive_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </div>

    <span class="k">def</span> <span class="nf">__validate_table_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_info</span><span class="p">):</span>

        <span class="n">validate_type</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.auto_create&quot;</span><span class="p">),</span>
                      <span class="s1">&#39;auto_create&#39;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.database&quot;</span><span class="p">),</span> <span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">validate_type</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.table&quot;</span><span class="p">),</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_common_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">):</span>
        <span class="n">common_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;common_configuration.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;common_configuration.json file is missing in archive file&quot;</span><span class="p">)</span>

            <span class="n">json_content</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;common_configuration.json&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json_content</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">common_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">common_config</span>

    <span class="k">def</span> <span class="nf">__get_fairness_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">):</span>
        <span class="n">fairness_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;fairness_statistics.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;fairness_statistics.json file is missing in archive file&quot;</span><span class="p">)</span>

            <span class="n">json_content</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;fairness_statistics.json&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json_content</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">fairness_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fairness_config</span>

    <span class="k">def</span> <span class="nf">__get_explainability_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">):</span>
        <span class="n">explain_stats</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
            <span class="n">json_content</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;explainability_statistics.json&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json_content</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">explain_stats</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">explain_stats</span>

    <span class="k">def</span> <span class="nf">__get_target_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Target</span><span class="p">(</span>
            <span class="n">target_type</span><span class="o">=</span><span class="n">TargetTypes</span><span class="o">.</span><span class="n">SUBSCRIPTION</span><span class="p">,</span>
            <span class="n">target_id</span><span class="o">=</span><span class="n">subscription_id</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__create_fairness_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">configuration</span><span class="p">):</span>

        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_target_obj</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="s2">&quot;parameters&quot;</span><span class="p">)</span>
        <span class="n">thresholds</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="s2">&quot;thresholds&quot;</span><span class="p">)</span>

        <span class="n">monitor_instance_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
            <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">FAIRNESS</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>

        <span class="k">return</span> <span class="n">monitor_instance_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">__create_explain_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">explain_statistics</span><span class="p">,</span> <span class="n">explain_queue_table</span><span class="p">,</span> <span class="n">explain_results_table</span><span class="p">,</span> <span class="n">data_sources</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">):</span>

        <span class="c1"># Upload explainability tar</span>
        <span class="n">archive_file</span> <span class="o">=</span> <span class="s2">&quot;explainability.tar.gz&quot;</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">configuration_archive</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;explainability.tar.gz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;explainability_perturbations.tar.gz&quot;</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                <span class="n">archive_file</span> <span class="o">=</span> <span class="s2">&quot;explainability_perturbations.tar.gz&quot;</span>

            <span class="n">tar_file</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="n">archive_file</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tar_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">explainability_tar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_instances</span><span class="o">.</span><span class="n">upload_explainability_archive</span><span class="p">(</span>
                <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="n">explainability_tar</span><span class="p">)</span>

        <span class="n">explain_integrated_system_id</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
            <span class="n">data_sources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;connection.integrated_system_id&quot;</span><span class="p">)</span>
        <span class="n">source_type</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">data_sources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;connection.type&quot;</span><span class="p">)</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;parameters&quot;</span> <span class="ow">in</span> <span class="n">explain_queue_table</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">explain_queue_table</span><span class="p">,</span> <span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">explain_queue_table</span><span class="p">[</span><span class="s1">&#39;parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="n">explain_queue_data_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_data_source</span><span class="p">(</span>
            <span class="n">explain_queue_table</span><span class="p">,</span> <span class="n">explain_integrated_system_id</span><span class="p">,</span> <span class="s2">&quot;explain_queue&quot;</span><span class="p">,</span> <span class="n">source_type</span><span class="p">)</span>

        <span class="n">additional_perturbation_param</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;perturbations_file&quot;</span><span class="p">:</span> <span class="n">archive_file</span><span class="p">}</span>
        <span class="n">explain_result_data_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_data_source</span><span class="p">(</span>
            <span class="n">explain_results_table</span><span class="p">,</span> <span class="n">explain_integrated_system_id</span><span class="p">,</span> <span class="s2">&quot;explain_result&quot;</span><span class="p">,</span> <span class="n">source_type</span><span class="p">,</span> <span class="n">additional_params</span><span class="o">=</span><span class="n">additional_perturbation_param</span><span class="p">)</span>
        <span class="c1"># Patch subscription with additional source</span>
        <span class="n">data_source_patch_document</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">JsonPatchOperation</span><span class="p">(</span>
                <span class="n">op</span><span class="o">=</span><span class="n">OperationTypes</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data_sources/-&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">explain_queue_data_source</span><span class="p">),</span>
            <span class="n">JsonPatchOperation</span><span class="p">(</span>
                <span class="n">op</span><span class="o">=</span><span class="n">OperationTypes</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data_sources/-&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">explain_result_data_source</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">patch_document</span><span class="o">=</span><span class="n">data_source_patch_document</span><span class="p">)</span>

        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_target_obj</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">explain_statistics</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;training_statistics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explain_statistics</span>

        <span class="n">explainability_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_explainability_parameters</span><span class="p">(</span>
            <span class="n">archive_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">explainability_parameters</span><span class="p">:</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">explainability_parameters</span><span class="p">)</span>

        <span class="n">monitor_instance_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
            <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">EXPLAINABILITY</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>

        <span class="k">return</span> <span class="n">monitor_instance_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">__get_explainability_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">explain_archive</span><span class="p">):</span>
        <span class="n">explain_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">explain_archive</span><span class="p">,</span> <span class="s2">&quot;r:gz&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;configuration.json&quot;</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
                <span class="n">json_content</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s2">&quot;configuration.json&quot;</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json_content</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
                <span class="n">explain_params</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">explain_params</span>

    <span class="k">def</span> <span class="nf">__create_quality_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">):</span>

        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_target_obj</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;min_feedback_data_size&quot;</span><span class="p">:</span> <span class="mi">100</span>
        <span class="p">}</span>
        <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[{</span>
            <span class="s2">&quot;metric_id&quot;</span><span class="p">:</span> <span class="s2">&quot;area_under_roc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lower_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mf">0.8</span>
        <span class="p">}]</span>
        <span class="n">monitor_instance_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
            <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">QUALITY</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>

        <span class="k">return</span> <span class="n">monitor_instance_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">__create_drift_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datamart_id</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">,</span> <span class="n">configuration_archive</span><span class="p">,</span> <span class="n">common_configuration</span><span class="p">,</span> <span class="n">drifted_transaction_table</span><span class="p">,</span> <span class="n">data_sources</span><span class="p">):</span>

        <span class="n">drift_integrated_system_id</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
            <span class="n">data_sources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;connection.integrated_system_id&quot;</span><span class="p">)</span>
        <span class="n">source_type</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">data_sources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;connection.type&quot;</span><span class="p">)</span>

        <span class="n">drift_data_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_data_source</span><span class="p">(</span>
            <span class="n">drifted_transaction_table</span><span class="p">,</span> <span class="n">drift_integrated_system_id</span><span class="p">,</span> <span class="s2">&quot;drift&quot;</span><span class="p">,</span> <span class="n">source_type</span><span class="p">)</span>
        <span class="n">data_source_patch_document</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">JsonPatchOperation</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">OperationTypes</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span>
                               <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data_sources/-&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">drift_data_source</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">patch_document</span><span class="o">=</span><span class="n">data_source_patch_document</span><span class="p">)</span>

        <span class="c1"># Enable the monitor</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_target_obj</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># &quot;min_samples&quot;: 1000,</span>
            <span class="s2">&quot;min_samples&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
            <span class="s2">&quot;drift_threshold&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="s2">&quot;train_drift_model&quot;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

        <span class="n">drift_monitor_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">data_mart_id</span><span class="o">=</span><span class="n">datamart_id</span><span class="p">,</span>
            <span class="n">monitor_definition_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="o">.</span><span class="n">monitor_definitions</span><span class="o">.</span><span class="n">MONITORS</span><span class="o">.</span><span class="n">DRIFT</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
            <span class="c1"># parameters=get(common_configuration,&quot;drift_parameters&quot;,{})</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span>
        <span class="p">)</span><span class="o">.</span><span class="n">result</span>

        <span class="k">return</span> <span class="n">drift_monitor_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">__get_data_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_info</span><span class="p">,</span> <span class="n">integrated_system_id</span><span class="p">,</span> <span class="n">table_type</span><span class="p">,</span> <span class="n">source_type</span><span class="p">,</span> <span class="n">additional_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">auto_create</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.auto_create&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">DataSourceStatus</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;parameters&quot;</span> <span class="ow">in</span> <span class="n">table_info</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;parameters&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">additional_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_params</span><span class="p">)</span>

        <span class="n">data_source</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">table_type</span><span class="p">,</span>
            <span class="n">database_name</span><span class="o">=</span><span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.database&quot;</span><span class="p">),</span>
            <span class="n">schema_name</span><span class="o">=</span><span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.database&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">source_type</span> <span class="o">==</span> <span class="n">IntegratedSystemsListEnums</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">HIVE</span><span class="o">.</span><span class="n">value</span> <span class="k">else</span> <span class="n">get</span><span class="p">(</span>
                <span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.schema&quot;</span><span class="p">),</span>
            <span class="n">table_name</span><span class="o">=</span><span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;data.table&quot;</span><span class="p">),</span>
            <span class="n">auto_create</span><span class="o">=</span><span class="n">auto_create</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
            <span class="n">connection</span><span class="o">=</span><span class="n">DataSourceConnection</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">source_type</span><span class="p">,</span>
                <span class="n">integrated_system_id</span><span class="o">=</span><span class="n">integrated_system_id</span>
            <span class="p">),</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">data_source</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__create_db2_hive_integrated_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_name</span><span class="p">,</span> <span class="n">table_info</span><span class="p">):</span>
        <span class="n">connection_type</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">)</span>
        <span class="n">hive_db2_connection</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;connection&quot;</span><span class="p">)</span>
        <span class="n">hive_db2_credentials</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hive_db2_credentials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hive_db2_credentials</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">connection_type</span> <span class="o">==</span> <span class="n">IntegratedSystemsListEnums</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">HIVE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">hive_db2_connection</span><span class="p">[</span><span class="s2">&quot;location_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;metastore&quot;</span>
        <span class="k">elif</span> <span class="n">connection_type</span> <span class="o">==</span> <span class="n">IntegratedSystemsListEnums</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">JDBC</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">hive_db2_connection</span><span class="p">[</span><span class="s2">&quot;location_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IntegratedSystemsListEnums</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">JDBC</span><span class="o">.</span><span class="n">value</span>
            <span class="n">hive_db2_credentials</span><span class="p">[</span><span class="s2">&quot;jdbc_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span>
                <span class="n">table_info</span><span class="p">,</span> <span class="s2">&quot;connection.jdbc_url&quot;</span><span class="p">)</span>
        <span class="n">hive_db2_connection_details</span> <span class="o">=</span> <span class="n">IntegratedSystems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">subscription_name</span> <span class="o">+</span> <span class="s2">&quot; - DB Info&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">connection_type</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">hive_db2_credentials</span><span class="p">,</span>
            <span class="n">connection</span><span class="o">=</span><span class="n">hive_db2_connection</span>
        <span class="p">)</span><span class="o">.</span><span class="n">result</span>
        <span class="n">hive_db2_connection_id</span> <span class="o">=</span> <span class="n">hive_db2_connection_details</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">id</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hive/Db2 Integrated system </span><span class="si">{}</span><span class="s2"> created&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hive_db2_connection_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">hive_db2_connection_id</span>

    <span class="k">def</span> <span class="nf">__delete_integrated_sytems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cleaning up integration systems&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Deleting </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
                <span class="n">IntegratedSystems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ai_client</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__validate_fairness_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>
        <span class="n">supported_metrics</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">metric_name</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">metric_name</span> <span class="ow">in</span> <span class="n">FairnessMetrics</span><span class="p">]</span>
        <span class="n">un_supported_metrics</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
            <span class="n">metric_ids</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="s2">&quot;metric_ids&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">metric_ids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">metric_id</span> <span class="ow">in</span> <span class="n">metric_ids</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">metric_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_metrics</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">metric_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">un_supported_metrics</span><span class="p">:</span>
                            <span class="n">un_supported_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">un_supported_metrics</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Metric ids </span><span class="si">{}</span><span class="s2"> are invalid. Please use the FairnessMetrics enum class for the correct metric ids&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">un_supported_metrics</span><span class="p">))</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on May 29, 2023.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>